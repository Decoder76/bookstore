<div align="right">
<p style="color: green"><%= notice %></p>
</div>
<h1>Book </h1>

<div class="row">
<% @books.each do |book| %>
<div class="col-md-3">
    <div class="card p-2 mb-2">
        <div class="d-flex justify-content-between">
            <div class="d-flex flex-row align-items-center">
                <div class="icon"> <i class="bx bxl-mailchimp"></i> </div>
                <div class="ms-2 c-details">
                    <h6 class="mb-0">
                        <%= link_to book.title , user_book_path(current_user, book) %>
                        </h6> 
                        <span><%= book.written_at%></span>
                </div>
            </div>
            <div class="badge"> <span>Design</span> </div>
        </div>
        <div class="mt-5">
            <%# if book.page.attached?%>
              <%= link_to image_tag("Book-cover-page.png",style:"width:10rem; height:15rem;border-radius:0%;border:2px;solid:#0d6efd;")%>
            <%#end%>
             <div class="mt-5">
                <div class="progress">
                    <div class="progress-bar" role="progressbar" style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100">
                    </div>
                </div>
                <div class="mt-3">
                    <span class="text1">
                        <p id="like-count"><%= book.likes %></p>
                        <%= link_to "Like", book_likes_path(current_user,book,@likes),class:"btn btn-sm btn-primary"%> 
                        <script>
                          document.addEventListener('DOMContentLoaded', function () {
                            const likeButton = document.getElementById('like-button');
                            const likeCount = document.getElementById('like-count');
                            let isLiked = false;
                            
                            likeButton.addEventListener('click', function () {
                              if (!isLiked) {
                                // Simulate an AJAX request to update the like count on the server
                                // You can use a real AJAX call to update the like count in the database
                                // For demonstration, we're just incrementing the count here.
                                book.likes_count += 1; // Update the like count on the server
                                
                                // Update the view with the new like count
                                likeCount.textContent = book.likes_count;
                                likeButton.textContent = 'Unlike';
                                isLiked = true;
                              } else {
                                // Handle unliking logic here
                                // This would involve sending a request to remove the like from the server
                                // and decrementing the like count.
                              }
                            });
                          });
                        </script>       
                    </span> 
                </div>
            </div>
        </div>
        <div class="row mb">
        <div class="col">
            <%= link_to "Edit", edit_user_book_path(current_user,book), class:"btn btn-success"%>
        </div>
        <div class="col">
            <%#= link_to "Back", user_books_path(book), class:"btn btn-warning"%>
        </div>
        <div class="col">
            <%= button_to "Destroy", user_book_path(current_user, book), method: :delete, class:"btn btn-danger" %>
        </div>
        </div>
    </div>
</div>
<% end %>
</div>




<!-- Your content continues here -->
<!-- Your content here -->
